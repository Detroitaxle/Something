<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Link Tree & ETA Tracker</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="icon" href="./assets/favicon.ico">
</head>
<body>
    <div class="container">
        <!-- Left Sidebar - Link Tree -->
        <aside class="sidebar">
            <div class="link-tree-header">
                <h2>My Links</h2>
                <button id="edit-mode-toggle">Edit Mode</button>
            </div>
            <div id="link-tree-container">
                <!-- Content will be loaded by JavaScript -->
                <div class="loading-message">Loading links...</div>
            </div>
            <div class="link-controls">
                <button id="add-group-btn">Add Group</button>
                <button id="add-link-btn">Add Link</button>
                <div id="bulk-edit-controls" class="hidden">
                    <button id="bulk-delete-btn">Delete Selected</button>
                    <select id="group-selector"></select>
                    <button id="bulk-move-btn">Move to Group</button>
                </div>
            </div>
        </aside>

        <!-- Main Content - ETA Tracker -->
        <main class="content">
            <div class="warehouse-selector">
                <h1>Warehouse ETA Tracker</h1>
                <div class="warehouse-tabs">
                    <button class="warehouse-tab active" data-warehouse="texas">Texas</button>
                    <button class="warehouse-tab" data-warehouse="detroit">Detroit</button>
                </div>
            </div>
            
            <div class="search-container">
                <input type="text" id="state-search" placeholder="Search by state abbreviation..." autocomplete="off">
            </div>
            
            <div id="eta-results">
                <!-- Content will be loaded by JavaScript -->
                <div class="loading-message">Loading ETA data...</div>
            </div>
        </main>
    </div>

    <!-- JavaScript Files with error handling -->
    <script>
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = () => reject(new Error(`Failed to load ${src}`));
                document.body.appendChild(script);
            });
        }

        async function initializeApp() {
            try {
                await loadScript('./js/states-data.js');
                await loadScript('./js/eta-data.js');
                await loadScript('./js/link-manager.js');
                await loadScript('./js/eta-calculator.js');
                await loadScript('./js/main.js');
                
                // Hide loading messages
                document.querySelectorAll('.loading-message').forEach(el => el.remove());
                
                console.log('All scripts loaded successfully');
            } catch (error) {
                console.error('Error loading scripts:', error);
                document.querySelectorAll('.loading-message').forEach(el => {
                    el.textContent = 'Error loading application. Please check console.';
                    el.style.color = 'red';
                });
            }
        }

        // Start loading after DOM is ready
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
